<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sunday</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #0a0a0a;
      color: #fff;
      min-height: 100vh;
      padding-bottom: 100px;
    }

    .header {
      padding: 40px 24px 20px;
    }

    .date-row {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
      color: #888;
      font-size: 14px;
    }

    .title {
      font-size: 32px;
      font-weight: 700;
      letter-spacing: -0.5px;
      margin-bottom: 4px;
    }

    .subtitle {
      color: #666;
      font-size: 15px;
    }

    .record-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 40px 0;
    }

    .record-button {
      width: 100px;
      height: 100px;
      border-radius: 24px;
      background: #1a1a1a;
      border: 2px solid #333;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
    }

    .record-button:hover {
      border-color: #7c3aed;
      background: #1f1a2e;
    }

    .record-button.recording {
      border-color: #7c3aed;
      background: #1f1a2e;
      animation: pulse 1.6s ease-in-out infinite;
    }

    .record-button.recording::before {
      content: '';
      position: absolute;
      width: 120px;
      height: 120px;
      border-radius: 28px;
      background: #7c3aed;
      opacity: 0.4;
      z-index: -1;
      animation: glow 1.6s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    @keyframes glow {
      0%, 100% { opacity: 0.3; transform: scale(1); }
      50% { opacity: 0.6; transform: scale(1.1); }
    }

    .mic-icon {
      width: 32px;
      height: 32px;
      fill: none;
      stroke: #fff;
      stroke-width: 2;
    }

    .stop-icon {
      width: 20px;
      height: 20px;
      background: #ef4444;
      border-radius: 4px;
    }

    .record-hint {
      color: #666;
      font-size: 14px;
      margin-top: 20px;
    }

    .recordings-section {
      padding: 0 24px;
    }

    .recordings-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }

    .recordings-title {
      font-size: 16px;
      font-weight: 600;
    }

    .extract-button {
      display: flex;
      align-items: center;
      gap: 6px;
      background: #7c3aed;
      padding: 8px 14px;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      border: none;
      color: #fff;
    }

    .extract-button:hover {
      background: #6d28d9;
    }

    .empty-state {
      padding: 60px 0;
      text-align: center;
      color: #444;
      font-size: 15px;
      line-height: 1.5;
    }

    .recording-item {
      display: flex;
      align-items: center;
      background: #141414;
      border-radius: 16px;
      padding: 16px;
      margin-bottom: 12px;
      border: 1px solid #222;
    }

    .play-button {
      width: 44px;
      height: 44px;
      border-radius: 22px;
      background: #1a1a1a;
      border: 1px solid #333;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      margin-right: 14px;
      flex-shrink: 0;
    }

    .play-button:hover {
      border-color: #7c3aed;
    }

    .play-icon {
      width: 0;
      height: 0;
      border-left: 10px solid #fff;
      border-top: 6px solid transparent;
      border-bottom: 6px solid transparent;
      margin-left: 3px;
    }

    .pause-icon {
      display: flex;
      gap: 3px;
    }

    .pause-bar {
      width: 3px;
      height: 12px;
      background: #fff;
      border-radius: 1px;
    }

    .recording-info {
      flex: 1;
      min-width: 0;
    }

    .recording-meta {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 10px;
    }

    .recording-time {
      color: #888;
      font-size: 13px;
    }

    .recording-duration {
      color: #555;
      font-size: 13px;
    }

    .progress-bar {
      height: 4px;
      background: #2a2a2a;
      border-radius: 2px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: #7c3aed;
      border-radius: 2px;
      width: 0%;
      transition: width 0.1s linear;
    }

    .tab-bar {
      position: fixed;
      bottom: 30px;
      left: 24px;
      right: 24px;
      display: flex;
      background: #141414;
      border-radius: 24px;
      padding: 8px;
      border: 1px solid #222;
    }

    .tab {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 12px;
      border-radius: 18px;
      gap: 4px;
      cursor: pointer;
      color: #666;
      font-size: 12px;
      font-weight: 500;
      border: none;
      background: transparent;
    }

    .tab.active {
      background: #7c3aed;
      color: #fff;
    }

    .tab-icon {
      width: 20px;
      height: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .delete-btn {
      background: none;
      border: none;
      color: #666;
      cursor: pointer;
      padding: 8px;
      margin-left: 8px;
      font-size: 18px;
    }

    .delete-btn:hover {
      color: #ef4444;
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="date-row">
      <span>üìÖ</span>
      <span id="currentDate"></span>
    </div>
    <h1 class="title">Record</h1>
    <p class="subtitle">Capture your activities with voice notes</p>
  </header>

  <section class="record-section">
    <button class="record-button" id="recordBtn">
      <svg class="mic-icon" id="micIcon" viewBox="0 0 24 24">
        <path d="M12 1a4 4 0 0 0-4 4v6a4 4 0 0 0 8 0V5a4 4 0 0 0-4-4z"/>
        <path d="M19 10v1a7 7 0 0 1-14 0v-1"/>
        <line x1="12" y1="19" x2="12" y2="23"/>
        <line x1="8" y1="23" x2="16" y2="23"/>
      </svg>
      <div class="stop-icon" id="stopIcon" style="display: none;"></div>
    </button>
    <p class="record-hint" id="recordHint">Tap to start recording your activity</p>
  </section>

  <section class="recordings-section">
    <div class="recordings-header">
      <h2 class="recordings-title" id="recordingsTitle">Today's Recordings (0)</h2>
      <button class="extract-button" id="extractBtn" style="display: none;">
        ‚ú® Extract Tasks ‚Ä∫
      </button>
    </div>
    <div id="recordingsList">
      <div class="empty-state">
        No recordings yet today.<br>Tap the microphone to start.
      </div>
    </div>
  </section>

  <nav class="tab-bar">
    <button class="tab active">
      <div class="tab-icon">üéôÔ∏è</div>
      <span>Record</span>
    </button>
    <button class="tab">
      <div class="tab-icon">üìã</div>
      <span>Tasks</span>
    </button>
    <button class="tab">
      <div class="tab-icon">üìä</div>
      <span>Insights</span>
    </button>
  </nav>

  <script>
    // State
    let isRecording = false;
    let mediaRecorder = null;
    let audioChunks = [];
    let recordings = [];
    let recordingStartTime = null;
    let durationInterval = null;
    let currentlyPlaying = null;
    let currentAudio = null;

    // Elements
    const recordBtn = document.getElementById('recordBtn');
    const micIcon = document.getElementById('micIcon');
    const stopIcon = document.getElementById('stopIcon');
    const recordHint = document.getElementById('recordHint');
    const recordingsList = document.getElementById('recordingsList');
    const recordingsTitle = document.getElementById('recordingsTitle');
    const extractBtn = document.getElementById('extractBtn');
    const currentDate = document.getElementById('currentDate');

    // Format date
    function formatDate() {
      const date = new Date();
      return date.toLocaleDateString('en-US', {
        weekday: 'long',
        month: 'long',
        day: 'numeric'
      });
    }

    // Format time
    function formatTime(date) {
      return date.toLocaleTimeString('en-US', {
        hour: 'numeric',
        minute: '2-digit',
        hour12: true
      });
    }

    // Format duration
    function formatDuration(ms) {
      const totalSeconds = Math.floor(ms / 1000);
      const minutes = Math.floor(totalSeconds / 60);
      const seconds = totalSeconds % 60;
      return `${minutes}:${seconds.toString().padStart(2, '0')}`;
    }

    // Initialize date
    currentDate.textContent = formatDate();

    // Start recording
    async function startRecording() {
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
        mediaRecorder = new MediaRecorder(stream);
        audioChunks = [];

        mediaRecorder.ondataavailable = (e) => {
          audioChunks.push(e.data);
        };

        mediaRecorder.onstop = () => {
          const audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
          const audioUrl = URL.createObjectURL(audioBlob);
          const duration = Date.now() - recordingStartTime;

          recordings.unshift({
            id: Date.now().toString(),
            url: audioUrl,
            timestamp: new Date(),
            duration: duration
          });

          renderRecordings();
          stream.getTracks().forEach(track => track.stop());
        };

        mediaRecorder.start();
        recordingStartTime = Date.now();
        isRecording = true;
        updateUI();

        durationInterval = setInterval(() => {
          const elapsed = Date.now() - recordingStartTime;
          recordHint.textContent = `Recording... ${formatDuration(elapsed)}`;
        }, 100);

      } catch (err) {
        console.error('Failed to start recording:', err);
        alert('Could not access microphone. Please allow microphone access.');
      }
    }

    // Stop recording
    function stopRecording() {
      if (mediaRecorder && mediaRecorder.state !== 'inactive') {
        mediaRecorder.stop();
      }
      if (durationInterval) {
        clearInterval(durationInterval);
        durationInterval = null;
      }
      isRecording = false;
      updateUI();
    }

    // Toggle recording
    function toggleRecording() {
      if (isRecording) {
        stopRecording();
      } else {
        startRecording();
      }
    }

    // Update UI
    function updateUI() {
      if (isRecording) {
        recordBtn.classList.add('recording');
        micIcon.style.display = 'none';
        stopIcon.style.display = 'block';
      } else {
        recordBtn.classList.remove('recording');
        micIcon.style.display = 'block';
        stopIcon.style.display = 'none';
        recordHint.textContent = 'Tap to start recording your activity';
      }
    }

    // Play recording
    function playRecording(id) {
      const recording = recordings.find(r => r.id === id);
      if (!recording) return;

      // Stop current audio if playing
      if (currentAudio) {
        currentAudio.pause();
        currentAudio = null;
      }

      if (currentlyPlaying === id) {
        currentlyPlaying = null;
        renderRecordings();
        return;
      }

      const audio = new Audio(recording.url);
      currentAudio = audio;
      currentlyPlaying = id;

      audio.ontimeupdate = () => {
        const progress = (audio.currentTime / audio.duration) * 100;
        const progressBar = document.querySelector(`[data-id="${id}"] .progress-fill`);
        if (progressBar) {
          progressBar.style.width = `${progress}%`;
        }
      };

      audio.onended = () => {
        currentlyPlaying = null;
        currentAudio = null;
        renderRecordings();
      };

      audio.play();
      renderRecordings();
    }

    // Delete recording
    function deleteRecording(id) {
      recordings = recordings.filter(r => r.id !== id);
      if (currentlyPlaying === id && currentAudio) {
        currentAudio.pause();
        currentAudio = null;
        currentlyPlaying = null;
      }
      renderRecordings();
    }

    // Render recordings
    function renderRecordings() {
      const today = new Date().toDateString();
      const todayRecordings = recordings.filter(r => r.timestamp.toDateString() === today);

      recordingsTitle.textContent = `Today's Recordings (${todayRecordings.length})`;
      extractBtn.style.display = todayRecordings.length > 0 ? 'flex' : 'none';

      if (todayRecordings.length === 0) {
        recordingsList.innerHTML = `
          <div class="empty-state">
            No recordings yet today.<br>Tap the microphone to start.
          </div>
        `;
        return;
      }

      recordingsList.innerHTML = todayRecordings.map(recording => `
        <div class="recording-item" data-id="${recording.id}">
          <button class="play-button" onclick="playRecording('${recording.id}')">
            ${currentlyPlaying === recording.id
              ? '<div class="pause-icon"><div class="pause-bar"></div><div class="pause-bar"></div></div>'
              : '<div class="play-icon"></div>'
            }
          </button>
          <div class="recording-info">
            <div class="recording-meta">
              <span class="recording-time">‚è± ${formatTime(recording.timestamp)}</span>
              <span class="recording-duration">${formatDuration(recording.duration)}</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill"></div>
            </div>
          </div>
          <button class="delete-btn" onclick="deleteRecording('${recording.id}')">√ó</button>
        </div>
      `).join('');
    }

    // Event listeners
    recordBtn.addEventListener('click', toggleRecording);

    // Initial render
    renderRecordings();
  </script>
</body>
</html>
